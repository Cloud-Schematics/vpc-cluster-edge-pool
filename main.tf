##############################################################################
# Resource Group
##############################################################################

data ibm_resource_group group {
  name = var.resource_group
}

##############################################################################


##############################################################################
# Cluster Data
##############################################################################

data ibm_container_vpc_cluster cluster {
  name              = var.cluster_name
  resource_group_id = data.ibm_resource_group.group.id
}

##############################################################################


##############################################################################
# VPC Data
#############################################################################

data ibm_is_vpc vpc {
  name = var.vpc_name
}

#############################################################################


#############################################################################
# Get Subnet data from VPC Block
#############################################################################

locals {
  edge_subnet_data = [
    # Create a list of objects containing subnet names, ids, and zones if the
    # name is contained in var.subnet_names
    for i in data.ibm_is_vpc.vpc.subnets:
    {
      name = i.name
      id   = i.id
      zone = i.zone
    } if contains(var.subnet_names, i.name)
  ]
}

#############################################################################